#include <AutoItConstants.au3>

Run("C:\Program Files\Mozilla Firefox\firefox.exe C:\Users\offsec\Desktop\FlashPoC.html")
WinWaitActive("Mozilla Firefox")
Run("C:\Program Files\Windows Kits\10\Debuggers\x86\windbg.exe -WF C:\default.WEW")
Sleep(500)
WinWaitActive("WinDbg:10.0.17134.12 X86")
Send("{F6}")
MouseClick($MOUSE_CLICK_LEFT, 883, 163, 0.5)

; Scroll down to last process that is 'firefox.exe'
WinWaitActive("Attach to Process")
$timer = TimerInit()
while 1
    Send("{down}"); i want it to hold down this space for 3 secs
    If(TimerDiff($timer) > 2000) then ExitLoop
WEnd
Send("{enter}")

; pykd debug keystrokes
;$addr = InputBox("Enter desired break point", "e.g. 0x418a60")
;If $addr = 0 Then $addr = '0x418a60'

MouseClick($MOUSE_CLICK_LEFT, 1516,1089, 1)
Send(".load pykd")
Send("{enter}")
Send('{!}py -g c:\flash')
Send('{enter}')


; Run the exploit by enabling flash on firefox
MouseClick($MOUSE_CLICK_LEFT, 200,600,1)
Sleep(0.5)
MouseClick($MOUSE_CLICK_LEFT, 500,200,1)